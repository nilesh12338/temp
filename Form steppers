<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Step Form Wizard with Stepper</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
  <style>
    .step { display: none; }
    .step.active { display: block; }
    .slide-left { animation: slideLeft 0.5s forwards; }
    .slide-right { animation: slideRight 0.5s forwards; }
    @keyframes slideLeft {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(-100%); opacity: 0; }
    }
    @keyframes slideRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    #summary { display: none; }

    /* Stepper styles */
    .stepper {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      position: relative;
    }
    .stepper::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 10%;
      right: 10%;
      height: 2px;
      background: #dee2e6;
      z-index: 0;
    }
    .stepper .step-indicator {
      position: relative;
      z-index: 1;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      background: #dee2e6;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
    .stepper .active-indicator {
      background: #0d6efd;
      color: #fff;
    }
    .stepper .completed-indicator {
      background: #198754;
      color: #fff;
    }
  </style>
</head>
<body class="bg-light d-flex align-items-center justify-content-center vh-100">

<div class="card shadow-lg p-4" style="width:600px;">
  <h4 class="mb-3">Survey Form</h4>

  <!-- Stepper -->
  <div id="formStepper" class="stepper mb-4">
    <div class="step-indicator active-indicator" data-step="1">1</div>
    <div class="step-indicator" data-step="2">2</div>
    <div class="step-indicator" data-step="3">3</div>
    <div class="step-indicator" data-step="4">4</div>
    <div class="step-indicator" data-step="5">5</div>
  </div>
  
  <form id="surveyForm">
    <!-- Step 1 -->
    <div class="step active" id="step1">
      <label class="form-label">1. Choose your gender</label><br>
      <div class="form-check">
        <input type="radio" name="gender" value="Male" class="form-check-input" required> Male
      </div>
      <div class="form-check">
        <input type="radio" name="gender" value="Female" class="form-check-input"> Female
      </div>
    </div>

    <!-- Step 2 -->
    <div class="step" id="step2">
      <label class="form-label">2. Enter your city</label>
      <input type="text" name="city" class="form-control" required>
    </div>

    <!-- Step 3 (optional) -->
    <div class="step" id="step3">
      <label class="form-label">3. Enter monthly income (optional)</label>
      <input type="number" name="income" class="form-control">
    </div>

    <!-- Step 4 (optional, sub-questions) -->
    <div class="step" id="step4">
      <label class="form-label">4. Choose your qualification</label>
      <select id="qualification" name="qualification" class="form-select">
        <option value="">-- Select --</option>
        <option value="Graduate">Graduate</option>
        <option value="Post Graduate">Post Graduate</option>
        <option value="Doctorate">Doctorate</option>
      </select>

      <!-- Graduate sub-questions -->
      <div id="graduateFields" class="mt-3" style="display:none;">
        <label>4(a). College Name</label>
        <input type="text" name="college" class="form-control">
        <label class="mt-2">4(b). Year of Passout</label>
        <input type="number" name="passout" class="form-control">
      </div>

      <!-- Post Graduate sub-questions -->
      <div id="pgFields" class="mt-3" style="display:none;">
        <label>4(a). PG College Name</label>
        <input type="text" name="pgCollege" class="form-control">
        <label class="mt-2">4(b). PG Specialization</label>
        <input type="text" name="pgSpecialization" class="form-control">
      </div>
    </div>

    <!-- Step 5 -->
    <div class="step" id="step5">
      <label class="form-label">5. Do you agree with terms?</label><br>
      <div class="form-check">
        <input type="radio" name="terms" value="Yes" class="form-check-input" required> Yes
      </div>
      <div class="form-check">
        <input type="radio" name="terms" value="No" class="form-check-input"> No
      </div>
    </div>

    <!-- Navigation -->
    <div class="d-flex justify-content-between mt-4">
      <button type="button" class="btn btn-secondary" id="prevBtn" disabled>Back</button>
      <button type="button" class="btn btn-outline-secondary d-none" id="skipBtn">Skip</button>
      <button type="button" class="btn btn-primary" id="nextBtn">Next</button>
    </div>
  </form>

  <!-- Summary -->
  <div id="summary" class="mt-4">
    <h5 class="text-success">ðŸŽ‰ Congratulations! Form Submitted Successfully.</h5>
    <p class="fw-bold">Here is your summary:</p>
    <table class="table table-bordered">
      <tbody id="summaryTable"></tbody>
    </table>
  </div>
</div>

<script>
$(function(){
  let currentStep = 1;
  const totalSteps = 5;

  function updateStepper(step){
    $(".step-indicator").each(function(){
      const s = parseInt($(this).attr("data-step"));
      $(this).removeClass("active-indicator completed-indicator");
      if(s < step){
        $(this).addClass("completed-indicator");
      } else if(s === step){
        $(this).addClass("active-indicator");
      }
    });
  }

  function showStep(step, direction="forward") {
    $(".step").removeClass("active slide-left slide-right");
    const $current = $("#step" + currentStep);
    const $next = $("#step" + step);

    if(direction === "forward"){
      $current.addClass("slide-left");
      $next.addClass("slide-right active");
    } else {
      $current.addClass("slide-right");
      $next.addClass("slide-left active");
    }

    currentStep = step;
    updateStepper(currentStep);

    $("#prevBtn").prop("disabled", currentStep === 1);
    $("#nextBtn").text(currentStep === totalSteps ? "Submit" : "Next");

    if(currentStep === 3 || currentStep === 4){
      $("#skipBtn").removeClass("d-none");
    } else {
      $("#skipBtn").addClass("d-none");
    }
  }

  function validateStep(step){
    if(step === 3 || step === 4){ 
      return true;
    }
    return $("#surveyForm").valid();
  }

  $("#nextBtn").click(function(){
    if(currentStep < totalSteps){
      if(!validateStep(currentStep)) return;
      showStep(currentStep+1, "forward");
    } else {
      if(!$("#surveyForm").valid()) return;
      $("#surveyForm").hide();
      buildSummary();
      $("#summary").fadeIn();
    }
  });

  $("#prevBtn").click(function(){
    if(currentStep > 1){
      showStep(currentStep-1, "backward");
    }
  });

  $("#skipBtn").click(function(){
    if(currentStep < totalSteps){
      showStep(currentStep+1, "forward");
    }
  });

  $("#qualification").change(function(){
    $("#graduateFields, #pgFields").hide();
    if($(this).val() === "Graduate"){
      $("#graduateFields").show();
    } else if($(this).val() === "Post Graduate"){
      $("#pgFields").show();
    }
  });

  $("#surveyForm").validate({
    errorClass: "text-danger",
    rules: {
      gender: "required",
      city: "required",
      terms: "required"
    }
  });

  function buildSummary(){
    const formData = $("#surveyForm").serializeArray();
    $("#summaryTable").empty();
    formData.forEach(item=>{
      $("#summaryTable").append(`<tr><th>${item.name}</th><td>${item.value}</td></tr>`);
    });
  }

  updateStepper(currentStep);
});
</script>

</body>
</html>
